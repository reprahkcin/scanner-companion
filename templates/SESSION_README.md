# Scanner Session: XMP Workflow Guide

This directory contains a complete 3D scanner capture session with XMP pose data for RealityCapture import.

## Directory Contents

- `metadata.json` - Complete capture settings and calibration data
- `xmp_files/` - **Consolidated XMP files** (one per perspective/angle)
- `stack_XX/` - Individual focus stacks with raw images
- `rename_xmp_for_rc.py` - **Helper script** for final XMP renaming

## Quick Workflow

### 1. Focus Stack Your Images
Use Helicon Focus or similar to create one stacked image per angle from each `stack_XX/` directory.

### 2. Rename XMP Files
Run the helper script to rename XMP files to match your stacked images:

```bash
# Basic usage - creates files like: stacked_angle_000.xmp, stacked_angle_090.xmp, etc.
python rename_xmp_for_rc.py . "stacked_angle_{angle:03.0f}.xmp"

# Custom naming - use your specimen name
python rename_xmp_for_rc.py . "my_specimen_{angle:03.0f}.xmp"

# High precision angles (if needed)
python rename_xmp_for_rc.py . "specimen_{angle:06.2f}.xmp"
```

This creates a new `xmp_renamed/` directory with properly named XMP files.

### 3. Import to RealityCapture
1. Place your focus-stacked images and renamed XMP files in the same directory
2. Import both images and XMP files into RealityCapture
3. In Alignment settings:
   - Enable "Use camera priors"  
   - Increase "Position prior hardness" and "Orientation prior hardness"
4. Run alignment - your cameras should form a perfect ring around the object!

## XMP File Format

Each XMP file contains:
- **Camera position** in meters (xcr:Position)
- **Camera rotation** matrix (xcr:Rotation)  
- **Scanner metadata** (distance, rail angle, etc.)

The coordinate system treats the camera as moving around a stationary object in a circle.

## Troubleshooting

- **XMP files not loading?** Make sure they have the same base name as your images
- **Cameras not in a ring?** Check your lens distance and rail angle settings
- **Poor alignment?** Increase prior hardness values in RealityCapture

## Session Info

Generated by Scanner Companion v1.0
See metadata.json for complete capture parameters.